<p align="center">ASPIRE MINI TEST PROJECT</p>

## Requirement
PHP >= 7.1.3
OpenSSL PHP Extension
PDO PHP Extension
Mbstring PHP Extension
Tokenizer PHP Extension
XML PHP Extension
Ctype PHP Extension
JSON PHP Extension
BCMath PHP Extension

Mysql >= 5.6
nginx >= 1.10
Laravel 5.7

or you can use docker-compose provided files

## Setup Project
- Extract aspire.zip to your webserver's root document (Ex: /var/www/html/aspire)
- Change your DB connection detail in .env
- Run: composer install
- Run: php artisan migrate (to create project's tables in Mysql) 
- Hit endpoint /api/setup to create default app's users (read detail users's info in api Response)

## APIs
- GET /api/setup

- POST /api/register
Desc: register new user
Parameters: 
    - name: string
    - email: string
    - password: string
    - password_confirmation: string
    - gender (optional): enum "Male"/"Female"
    - birthdate (optional): "Y-m-d"

Response Success(200):
    {
        "isSuccess": 1,
        "message": "User Registered"
    }    
Response Error(422):
    {
        "message": "The given data was invalid.",
        "errors": {
            "email": [
                "The email has already been taken."
            ]
        }
    }    

- POST /oauth/token
Parameter:
    - grant_type: "password"
    - client_id: integer
    - client_secret: string
    - username: string (user's email)
    - password: string (user's password)
    - scope: "*"

HINT: run >> php artisan passport install to generate default client ID and client secret for personal access and password type oauth clients

Response Success (200):
    {
        "token_type": "Bearer",
        "expires_in": 31536000,
        "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6IjhhNTczMzlkZjA3ZjdkYTFjYWY4M2RhOTA0YTZlNmUzNWI3YzQzZjM0Y2ZiNGUxNDRhZGM3MGEwNmMyN2MwNjc5MWU4NDRmMzgyZWZiYjIzIn0.eyJhdWQiOiIyIiwianRpIjoiOGE1NzMzOWRmMDdmN2RhMWNhZjgzZGE5MDRhNmU2ZTM1YjdjNDNmMzRjZmI0ZTE0NGFkYzcwYTA2YzI3YzA2NzkxZTg0NGYzODJlZmJiMjMiLCJpYXQiOjE1NDQzODc4NDUsIm5iZiI6MTU0NDM4Nzg0NSwiZXhwIjoxNTc1OTIzODQ1LCJzdWIiOiIxIiwic2NvcGVzIjpbIioiXX0.YUHr1tq899NgZNWOtHTqdLVdXZizVe9dFAWEz9SfOUbrk8IxFA5rem8z_TW09RIVAvNd-WtKL-KFXgJ51n-YL8xKdyzdCauIfA9FCOos5h99udhn8Lk-ckTq-bMY4LBl8XeVQrhK4IA8x_UI0zUnhkcul1u8rbrV7FIXtfkvvEsZOg2tSDTta8LD0hrDgN6Wr2tfD65weyrgQ_uBSdkta0O_bP0eoAuYKO6pkamr3VRIKtnC1W__GMP6fYFh-qWix3itWkVrPizbV5fvJatcgqbq3RMKEnGEOvE_Af2JmPpJMHfgQkMQ1jEjPGwYlBLOesGLZvhJDMfllsYnPVFpMbluTiZsOPJJ4mTJ93-dXkuflE7ul50QdkwjRVha9HiIxlsnUQh7ooo6cWX3HOFti18GDI9HU-DvH0aMK9FzhRCb_1Y8y-pnXk1o3nGW_TA77rI6CLO6fL2ikCJR3gNXt57ENYr7Xz7N7CjcObK-_a3IbBYRKKS_OWnkq4L0xf3nkEpzcV3tcg1qUfYVsj0ZcB06GbeXkryCnYfY-yY2VeDZUDH67TcmB2-UioX5durBaT93LPgcYvx3-1wSB9nY7mqV8iOtJ0nGfELqGGtsXylUQ3RDqi8Q7mTUNXTroQubOI-Qv_fcdeQuHWubJdjf5jLUnv7Y6CBFHu2_1lrSgB0",
        "refresh_token": "def502003dc734600814ef436190ca015240bc35219b83e5941f1ed9bea86c0c91c9404214c0e8efcdd2a655f734f6f23d30eb9a3e6599eed92556eb7f9fb7462e69850fded7ceb258ff982d70111090af50541eaaffc463b992f87b761b704d14b03639556ff338a43bebeb16003b74411ef90243f18cc01b78aa5fbce91470d7d4258dd4366762ef6606c84f8a8a5d959c9eb73675f516b74d73b45bfa9701b49f8c6911e0176067b2c120492c1dd61a36b7a7af6bb48c698aa8c4b7ff8a42b08c4f940beb2a6b94bdf3e35fb6f4b89354df823af7ce2945b380865288b423a88b1ded615ce0648c4b41b4d466606c6026f1c7419681cdaeb06daede04e66009aab1702e7577c914ad2d77b202f2eab4c39a22d3a9c202909a79e1af50048608cec92a21ccd8ae59cc48daede0758cba55948f230aa9de034f91530082ed83043e6dce6b9244555bd81af4e098ba84b627abe0ac6715c4a324be34f508c53b8744458b"
    }

Response Error (401):
    {
        "error": "invalid_client",
        "message": "Client authentication failed"
    }

- POST /api/user/create-loan
Desc: User submit loan inquiry.
Authorization: Bearer + user's access token     

Parameter:
    - amount: integer
    - duration: integer (in month)
    - frequency: enum "monthly","quarterly","semester","yearly"
    - interest_rate: decimal(8,2)
    - arrangement_fee: integer

Response Success (200):
    {
        "isSuccess": 1,
        "message": "Loan created"
    }

Response Error (422):
    {
        "message": "The given data was invalid.",
        "errors": {
            "duration": [
                "The duration field is required."
            ]
        }
    }

- POST /api/user/list-payment
Desc: get list payment schedules generated by system after user's loan approved.
Authorization: Bearer + user's access token     
No parameter required

Response Success (200):
    [
        {
            "id": 1,
            "loan_id": 1,
            "user_id": 2,
            "installment_no": 0,
            "amount": 500000,
            "due_date": "2019-01-09",
            "payment_amount": null,
            "payment_date": null,
            "penalty": null,
            "payment_method": null,
            "status": null,
            "created_by": 2,
            "updated_by": 2,
            "created_at": null,
            "updated_at": null,
            "proof_of_payment": null
        },.....
    ]

Response Error (401):
    {
        "message": "Unauthenticated."
    }

- POST /api/user/confirm-payment
Desc: user do payment confirmation
Authorization: Bearer + user's access token
Parameters:
    - payment_amount: integer
    - payment_date: "Y-m-d"
    - payment_method: enum "Bank transfer", "Autodebet", "Credit Card"

Response Success (200):
    {
        "isSuccess": 1,
        "message": "Payment Confirmation submitted"
    }

Response Error (401):
    {
        "message": "Unauthenticated."
    }

- POST /api/admin/approve-loan

- POST /api/admin/reject-loan

- POST /api/admin/verify-payment